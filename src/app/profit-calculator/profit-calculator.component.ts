import { Component, OnInit } from '@angular/core';
import { BattleReportParser, BattleReport } from './battle-report-parser';
import * as ClassicEditor from '@ckeditor/ckeditor5-build-classic';

@Component({
  selector: 'app-profit-calculator',
  templateUrl: './profit-calculator.component.html',
  styleUrls: ['./profit-calculator.component.scss']
})
export class ProfitCalculatorComponent implements OnInit {
  public Editor = ClassicEditor;
  public report: string = ``;
  public battleReport: BattleReport;
  public debug: boolean = false;

  constructor() { }

  ngOnInit() {
    //this.report = '<p>The attacker has won the battle obtaining 1,072,372 metal, 518,609 crystal and 151,107 Deuterium.<br>The attacker has lost a total of 0 units and 0 deuterium.<br>The defender has lost a total of 405,695,000 units and 33,805,000 deuterium.<br>A debris field of 33,552,000 metal and 21,013,800 crystal is now floating in orbit around the planet.<br>The chance for a moon to arise from the debris is 20%.</p><h4>Beginning of Battle</h4><figure class="table"><table><thead><tr><th><strong>Attackers</strong></th><th><strong>Defenders</strong></th></tr></thead><tbody><tr><td><p><strong>Greekgod2309 [2:55:7 (M)]</strong><br><strong>WSA:+170%/+170%/+180%</strong>Ships</p><p>Deathstar</p><p>220</p><p><strong>Rosete [2:47:11 (M)]</strong><br><strong>WSA:+170%/+160%/+170%</strong>Ships</p><p>Deathstar</p><p>82</p></td><td><p><strong>Unknown221 [2:47:10 (P)]</strong><br><strong>WSA:+130%/+130%/+130%</strong>Ships</p><p>Small Cargo</p><p>155</p><p>Large Cargo</p><p>80</p><p>Light Fighter</p><p>3,500</p><p>Heavy Fighter</p><p>1,500</p><p>Cruiser</p><p>40</p><p>Battleship</p><p>900</p><p>Recycler</p><p>100</p><p>Espionage Probe</p><p>100</p><p>Bomber</p><p>75</p><p>Destroyer</p><p>220</p><p>Deathstar</p><p>4</p><p>Battlecruiser</p><p>410</p><p>Defense</p><p>Rocket Launcher</p><p>19,045</p><p>Light Laser</p><p>8,800</p><p>Heavy Laser</p><p>5,603</p><p>Gauss Cannon</p><p>1,525</p><p>Ion Cannon</p><p>2,100</p><p>Plasma Turret</p><p>530</p><p>Small Shield Dome</p><p>1</p><p>Large Shield Dome</p><p>1</p><p><strong>TDizzle</strong><br><strong>WSA:+180%/+180%/+180%</strong>Ships</p><p>Espionage Probe</p><p>1</p></td></tr></tbody></table></figure><h4>End of Battle</h4><figure class="table"><table><thead><tr><th><strong>Attackers</strong></th><th><strong>Defenders</strong></th></tr></thead><tbody><tr><td><p><strong>Greekgod2309 [2:55:7 (M)]</strong><br><strong>WSA:+170%/+170%/+180%</strong>Ships</p><p>Deathstar</p><p>220</p><p><strong>Rosete [2:47:11 (M)]</strong><br><strong>WSA:+170%/+160%/+170%</strong>Ships</p><p>Deathstar</p><p>82</p></td><td><strong>Unknown221 [2:47:10 (P)]</strong><br><strong>WSA:+130%/+130%/+130%</strong>Destroyed<strong>TDizzle</strong><br><strong>WSA:+180%/+180%/+180%</strong>Destroyed</td></tr></tbody></table></figure><h4>After Round 1</h4><h4>After Round 2</h4><h4>After Round 3</h4><h4>After Round 4</h4><h4>After Round 5</h4>';
    //this.report = '<p>The attacker has won the battle obtaining 4,021,672 metal, 9,928,383 crystal and 24,267,306 Deuterium.<br>The attacker has lost a total of 7,670,000 units and 705,000 deuterium.<br>The defender has lost a total of 841,711,000 units and 63,111,000 deuterium.<br>A debris field of 159,053,400 metal and 95,760,900 crystal is now floating in orbit around the planet.<br>The chance for a moon to arise from the debris is 20%.</p><h4>Beginning of Battle</h4><figure class="table"><table><thead><tr><th><strong>Attackers</strong></th><th><strong>Defenders</strong></th></tr></thead><tbody><tr><td><p><strong>Satan [3:160:8 (M)]</strong><br><strong>WSA:+160%/+160%/+170%</strong>Ships</p><p>Battleship</p><p>31,000</p><p>Battlecruiser</p><p>40,000</p><p><strong>TDizzle [3:153:12 (M)]</strong><br><strong>WSA:+180%/+180%/+180%</strong>Ships</p><p>Espionage Probe</p><p>1</p></td><td><p><strong>Synnri [3:170:5 (M)]</strong><br><strong>WSA:+170%/+160%/+160%</strong>Ships</p><p>Small Cargo</p><p>9,522</p><p>Large Cargo</p><p>4,952</p><p>Light Fighter</p><p>47,819</p><p>Cruiser</p><p>3,051</p><p>Battleship</p><p>2,736</p><p>Colony Ship</p><p>15</p><p>Recycler</p><p>5,377</p><p>Espionage Probe</p><p>413</p><p>Deathstar</p><p>1</p><p>Battlecruiser</p><p>3,007</p><p><strong>TDizzle</strong><br><strong>WSA:+180%/+180%/+180%</strong>Ships</p><p>Espionage Probe</p><p>1</p></td></tr></tbody></table></figure><h4>End of Battle</h4><figure class="table"><table><thead><tr><th><strong>Attackers</strong></th><th><strong>Defenders</strong></th></tr></thead><tbody><tr><td><p><strong>Satan [3:160:8 (M)]</strong><br><strong>WSA:+160%/+160%/+170%</strong>Ships</p><p>Battleship</p><p>30,927</p><p>Battlecruiser</p><p>39,953</p><p><strong>TDizzle [3:153:12 (M)]</strong><br><strong>WSA:+180%/+180%/+180%</strong>Ships</p><p>Espionage Probe</p><p>1</p></td><td><strong>Synnri [3:170:5 (M)]</strong><br><strong>WSA:+170%/+160%/+160%</strong>Destroyed<strong>TDizzle</strong><br><strong>WSA:+180%/+180%/+180%</strong>Destroyed</td></tr></tbody></table></figure><h4>After Round 1</h4><h4>After Round 2</h4><h4>After Round 3</h4>';
    //this.report = '<p>The battle ended in a draw.<br>The attacker has lost a total of 9,000,000 units and 1,000,000 deuterium.<br>The defender has lost a total of 2,082,954,000 units and 101,989,500 deuterium.<br>A debris field of 44,839,800 metal and 41,056,800 crystal is now floating in orbit around the planet.<br>The chance for a moon to arise from the debris is 20%.</p><h4>Beginning of Battle</h4><figure class="table"><table><thead><tr><th><strong>Attackers</strong></th><th><strong>Defenders</strong></th></tr></thead><tbody><tr><td><p><strong>TDizzle [1:51:12 (M)]</strong><br><strong>WSA:+180%/+180%/+180%</strong>Ships</p><p>Deathstar</p><p>251</p><p><strong>Greekgod2309 [1:64:6 (M)]</strong><br><strong>WSA:+170%/+170%/+170%</strong>Ships</p><p>Deathstar</p><p>1,120</p></td><td><p><strong>Fallenheroes [1:44:6 (P)]</strong><br><strong>WSA:+180%/+170%/+180%</strong>Ships</p><p>Large Cargo</p><p>12,500</p><p>Solar Satellite</p><p>1,200</p><p>Deathstar</p><p>16</p><p>Defense</p><p>Rocket Launcher</p><p>500,000</p><p>Light Laser</p><p>100,000</p><p>Heavy Laser</p><p>20,000</p><p>Gauss Cannon</p><p>5,000</p><p>Ion Cannon</p><p>3,000</p><p>Plasma Turret</p><p>2,600</p><p>Small Shield Dome</p><p>1</p><p>Large Shield Dome</p><p>1</p></td></tr></tbody></table></figure><h4>End of Battle</h4><figure class="table"><table><thead><tr><th><strong>Attackers</strong></th><th><strong>Defenders</strong></th></tr></thead><tbody><tr><td><p><strong>TDizzle [1:51:12 (M)]</strong><br><strong>WSA:+180%/+180%/+180%</strong>Ships</p><p>Deathstar</p><p>251</p><p><strong>Greekgod2309 [1:64:6 (M)]</strong><br><strong>WSA:+170%/+170%/+170%</strong>Ships</p><p>Deathstar</p><p>1,119</p></td><td><p><strong>Fallenheroes [1:44:6 (P)]</strong><br><strong>WSA:+180%/+170%/+180%</strong>Ships</p><p>Large Cargo</p><p>89</p><p>Solar Satellite</p><p>5</p><p>Deathstar</p><p>2</p><p>Defense</p><p>Rocket Launcher</p><p>3,758</p><p>Light Laser</p><p>759</p><p>Heavy Laser</p><p>158</p><p>Gauss Cannon</p><p>34</p><p>Ion Cannon</p><p>25</p><p>Plasma Turret</p><p>18</p></td></tr></tbody></table></figure><h4>After Round 1</h4><h4>After Round 2</h4><h4>After Round 3</h4><h4>After Round 4</h4><h4>After Round 5</h4>';
    //this.report = '<p>The battle ended in a draw.<br>The attacker has lost a total of 608,201,000 units and 67,233,000 deuterium.<br>The defender has lost a total of 318,787,000 units and 24,564,500 deuterium.<br>A debris field of 118,309,800 metal and 64,328,700 crystal is now floating in orbit around the planet.<br>The chance for a moon to arise from the debris is 20%.</p><h4>Beginning of Battle</h4><figure class="table"><table><thead><tr><th><strong>Attackers</strong></th><th><strong>Defenders</strong></th></tr></thead><tbody><tr><td><p><strong>ChaosSuse [2:9:9 (M)]</strong><br><strong>WSA:+160%/+150%/+160%</strong>Ships</p><p>Light Fighter</p><p>8,723</p><p>Cruiser</p><p>100</p><p>Battleship</p><p>4,100</p><p>Colony Ship</p><p>23</p><p>Bomber</p><p>2,959</p><p>Destroyer</p><p>1,105</p><p>Battlecruiser</p><p>1,616</p></td><td><p><strong>Starsky [2:7:12 (P)]</strong><br><strong>WSA:+170%/+170%/+170%</strong>Ships</p><p>Solar Satellite</p><p>300</p><p>Defense</p><p>Rocket Launcher</p><p>50,000</p><p>Light Laser</p><p>10,000</p><p>Heavy Laser</p><p>10,000</p><p>Gauss Cannon</p><p>1,000</p><p>Ion Cannon</p><p>2,000</p><p>Plasma Turret</p><p>2,150</p><p>Small Shield Dome</p><p>1</p><p>Large Shield Dome</p><p>1</p></td></tr></tbody></table></figure><h4>End of Battle</h4><figure class="table"><table><thead><tr><th><strong>Attackers</strong></th><th><strong>Defenders</strong></th></tr></thead><tbody><tr><td><p><strong>ChaosSuse [2:9:9 (M)]</strong><br><strong>WSA:+160%/+150%/+160%</strong>Ships</p><p>Light Fighter</p><p>1</p><p>Cruiser</p><p>1</p><p>Battleship</p><p>486</p><p>Colony Ship</p><p>2</p><p>Bomber</p><p>575</p><p>Destroyer</p><p>370</p><p>Battlecruiser</p><p>280</p></td><td><p><strong>Starsky [2:7:12 (P)]</strong><br><strong>WSA:+170%/+170%/+170%</strong>Ships</p><p>Solar Satellite</p><p>3</p><p>Defense</p><p>Rocket Launcher</p><p>626</p><p>Light Laser</p><p>95</p><p>Heavy Laser</p><p>149</p><p>Gauss Cannon</p><p>147</p><p>Ion Cannon</p><p>91</p><p>Plasma Turret</p><p>1,393</p><p>Small Shield Dome</p><p>1</p><p>Large Shield Dome</p><p>1</p></td></tr></tbody></table></figure><h4>After Round 1</h4><h4>After Round 2</h4><h4>After Round 3</h4><h4>After Round 4</h4><h4>After Round 5</h4>';
    //this.report = '<p>The attacker has won the battle obtaining 72,889,931 metal, 54,025,769 crystal and 89,957,378 Deuterium.<br>The attacker has lost a total of 288,831,000 units and 15,645,000 deuterium.<br>The defender has lost a total of 3,040,421,000 units and 288,575,000 deuterium.<br>A debris field of 598,420,500 metal and 388,527,900 crystal is now floating in orbit around the planet.<br>The chance for a moon to arise from the debris is 20%.</p><h4>Beginning of Battle</h4><figure class="table"><table><thead><tr><th><strong>Attackers</strong></th><th><strong>Defenders</strong></th></tr></thead><tbody><tr><td><p><strong>Chimpo [2:52:12 (M)]</strong><br><strong>WSA:+170%/+180%/+170%</strong>Ships</p><p>Battleship</p><p>40,000</p><p>Battlecruiser</p><p>40,000</p><p><strong>TDizzle [2:27:12 (M)]</strong><br><strong>WSA:+180%/+180%/+180%</strong>Ships</p><p>Battleship</p><p>55,000</p><p>Battlecruiser</p><p>68,000</p><p><strong>TDizzle [2:27:12 (M)]</strong><br><strong>WSA:+180%/+180%/+180%</strong>Ships</p><p>Espionage Probe</p><p>1</p></td><td><p><strong>VenoM [2:36:11 (M)]</strong><br><strong>WSA:+180%/+180%/+180%</strong>Ships</p><p>Small Cargo</p><p>35,000</p><p>Large Cargo</p><p>9,150</p><p>Light Fighter</p><p>100,000</p><p>Cruiser</p><p>10,000</p><p>Battleship</p><p>10,000</p><p>Colony Ship</p><p>1</p><p>Recycler</p><p>9,001</p><p>Espionage Probe</p><p>641</p><p>Bomber</p><p>632</p><p>Destroyer</p><p>4,001</p><p>Deathstar</p><p>1</p><p>Battlecruiser</p><p>12,000</p><p>Defense</p><p>Rocket Launcher</p><p>17,857</p><p>Light Laser</p><p>372</p><p>Gauss Cannon</p><p>34</p><p>Ion Cannon</p><p>222</p></td></tr></tbody></table></figure><h4>End of Battle</h4><figure class="table"><table><thead><tr><th><strong>Attackers</strong></th><th><strong>Defenders</strong></th></tr></thead><tbody><tr><td><p><strong>Chimpo [2:52:12 (M)]</strong><br><strong>WSA:+170%/+180%/+170%</strong>Ships</p><p>Battleship</p><p>38,429</p><p>Battlecruiser</p><p>39,627</p><p><strong>TDizzle [2:27:12 (M)]</strong><br><strong>WSA:+180%/+180%/+180%</strong>Ships</p><p>Battleship</p><p>52,974</p><p>Battlecruiser</p><p>67,330</p><p><strong>TDizzle [2:27:12 (M)]</strong><br><strong>WSA:+180%/+180%/+180%</strong>Destroyed</p></td><td><strong>VenoM [2:36:11 (M)]</strong><br><strong>WSA:+180%/+180%/+180%</strong>Destroyed</td></tr></tbody></table></figure><h4>After Round 1</h4><h4>After Round 2</h4><h4>After Round 3</h4>';
    //this.parse();
  }

  public parse(): void {
    var parser: BattleReportParser = new BattleReportParser(this.report);
    this.battleReport = parser.parse();
  }

  public clear(): void {
    this.report = '';
    this.battleReport = undefined;
  }
}
